:root {
  --bg-color: hsl(0, 0%, 17%);
  --panel-color: #162D42;
  --button-bg: #70add6;
  --button-selected: #00cfff;
  --button-text: #fff;
  --input-bg: #8ed4ffa4;
  --input-text: #fff;
  --text-color: #eee;
  --select-linha: #328fce;
  --highlight: #8ED4FF;
  --border-radius: 6px;
  --key-w: 75px;
  --key-h: 33.75px;
  --gap-vertical: 8px;
  --gap-horizontal: 14px;
  --compound-gap: 3px;

  /* toolbar / numpad specific */
  --toolbar-bg: #49647C;
  --toolbar-btn-bg: rgba(151, 164, 175, 0.5);
  --numpad-scale: 1.0;
}

/* Reset / base */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html,
body {
  height: 100%;
}

body {
  font-family: "Segoe UI", Roboto, Arial, sans-serif;
  background: var(--bg-color);
  color: var(--text-color);
  padding: 10px;
  text-align: center;
}

/* Layout principal */
#app-grid {
  display: grid;
  grid-template-areas: "video controls" "keyboard .";
  grid-template-columns: auto 360px;
  gap: 12px 18px;
  justify-items: center;
  align-items: start;
}

/* vídeo / canvas */
#video-container {
  grid-area: video;
  position: relative;
  width: 420px;
  height: 260px;
  background: #000;
  border-radius: var(--border-radius);
  overflow: hidden;
}

#videoEl,
#overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

/* controls */
#controls {
  grid-area: controls;
  background: var(--panel-color);
  padding: 12px;
  border-radius: var(--border-radius);
  box-shadow: 0 0 5px rgba(0, 0, 0, .3);
  width: 360px;
}

#controls h2 {
  margin-bottom: 12px;
  font-size: 1.15em;
  text-align: left;
}

.config-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
}

.config-group {
  display: flex;
  flex-direction: column;
  text-align: left;
}

.config-buttons {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: var(--input-bg);
  padding: 6px 10px;
  border-radius: 6px;
}

.config-buttons button {
  background: var(--button-bg);
  color: var(--button-text);
  border: none;
  border-radius: 4px;
  padding: 6px 10px;
  cursor: pointer;
  font-size: .9em;
}

.config-buttons button:hover {
  background: var(--highlight);
}

/* keyboard panel */
#keyboard-panel {
  grid-area: keyboard;
  background: var(--panel-color);
  padding: 10px;
  border-radius: var(--border-radius);
  border: 2px solid #0a2340;
  width: calc((var(--key-w) * 6) + (var(--gap-horizontal) * 5) + 40px);
}

#output {
  width: 100%;
  padding: 8px;
  font-size: 1em;
  margin-bottom: 10px;
  background: var(--input-bg);
  color: var(--input-text);
  border: none;
  border-radius: 6px;
}

/* Toolbar */
.toolbar {
  background: var(--toolbar-bg);
  border-radius: var(--border-radius);
  padding: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 10px;
  min-height: 40px;
  box-sizing: border-box;
}

.toolbar .tool-group {
  display: flex;
  align-items: center;
  justify-content: space-around;
  width: 100%;
  gap: 8px;
}

.toolbar .tool-btn {
  width: 2.6em;
  height: 2.6em;
  border-radius: 50%;
  background: var(--toolbar-btn-bg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border: none;
  transition: transform .08s ease, background .08s ease;
  padding: 6px;
  box-sizing: border-box;
}

.toolbar .tool-btn .btn-icon {
  width: 100%;
  height: 100%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: #fff;
}

.toolbar .tool-btn:hover {
  transform: translateY(-3px);
}

/* toolbar selection highlight */
.toolbar .tool-btn.row-selected,
.toolbar .tool-btn.selected {
  background: var(--select-linha);
  color: #000;
}

#tool-123,
#tool-abc {
  width: 2.8em;
  height: 2.8em;
  min-width: 2.8em;
  min-height: 2.8em;
  padding: 0.12em;
  box-sizing: border-box;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

#tool-123 .btn-icon,
#tool-abc .btn-icon {
  width: 100%;
  height: 100%;
  padding: 0;
}

#tool-123 .btn-icon svg,
#tool-abc .btn-icon svg {
  width: 92%;
  height: 92%;
  display: block;
}

/* Keyboard (ABC) layout & controls */

/* grid base */
.grid-6cols {
  display: grid;
  grid-template-columns: repeat(6, var(--key-w));
  grid-auto-rows: var(--key-h);
  column-gap: var(--gap-horizontal);
  row-gap: var(--gap-vertical);
  justify-content: center;
}

/* button base (ABC) */
#keyboard>button {
  width: 100%;
  height: 100%;
  min-width: var(--key-w);
  min-height: var(--key-h);
  background: var(--button-bg);
  border: none;
  border-radius: 8px;
  font-size: 1em;
  font-weight: 700;
  color: #000;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: transform .06s ease;
  box-sizing: border-box;
}

/* compound wrapper (caps + gear, etc) */
.compound-cell {
  width: 100%;
  height: 100%;
  background: transparent;
  border: none;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: transform .06s ease;
  box-sizing: border-box;
}

.compound-cell {
  display: flex;
  flex-direction: row;
  gap: var(--compound-gap);
  align-items: stretch;
  justify-content: center;
  padding: 0;
}

.compound-cell .half-btn {
  flex: 1 1 0;
  width: 50%;
  height: 100%;
  border-radius: 6px;
  border: none;
  background: var(--button-bg);
  color: #000;
  font-weight: 700;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  padding: 0 6px;
  box-sizing: border-box;
}

/* hover */
#keyboard>button:hover,
#keyboard>.compound-cell .half-btn:hover {
  transform: translateY(-2px);
}

/* special key visuals */
#keyboard>button.key-special,
#keyboard .compound-cell .half-btn.key-special {
  background: #97ecff;
  color: #000;
}

/* space-row full-width bottom */
#keyboard .space-row {
  grid-column: 1 / -1;
  min-height: var(--key-h);
  height: var(--key-h);
  border-radius: 8px;
  background: var(--button-bg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  cursor: pointer;
  border: none;
  box-sizing: border-box;
}

/* Ícones */
.btn-icon {
  width: 1.6em;
  height: 1.6em;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.btn-icon svg {
  width: 100%;
  height: 100%;
  display: block;
}

.btn-icon:not(.preserve) svg {
  fill: currentColor;
  stroke: currentColor;
}

/* NUMPAD */

/* numpad container */
#keyboard[data-mode="numpad"] {
  display: grid;
  grid-template-columns: repeat(6, var(--key-w));
  /* 5 numeric columns + 1 special column; numeric rows double height */
  grid-auto-rows: calc(var(--key-h) * 2);
  column-gap: var(--gap-horizontal);
  row-gap: var(--gap-vertical);
  justify-content: center;
  align-items: start;
}

#keyboard[data-mode="numpad"] .space-row {
  grid-column: 1 / -1;
  min-height: 80%;
  height: 100%;
  border-radius: 8px;
  background: var(--button-bg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  cursor: pointer;
  border: none;
  box-sizing: border-box;
}

#keyboard[data-mode="numpad"] .num-btn {
  min-width: var(--key-w);
  min-height: calc(var(--key-h) * 2);
  border-radius: 8px;
  border: none;
  background: var(--button-bg);
  font-weight: 800;
  font-size: calc(1em * 1.3);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-sizing: border-box;
}

#keyboard[data-mode="numpad"] .special-wrapper {
  display: flex;
  flex-direction: column;
  gap: var(--gap-vertical);
  align-items: center;
  justify-content: stretch;
  /* total height equals two numeric rows + gap */
  height: calc((var(--key-h) * 2 * 2) + var(--gap-vertical));
  min-width: var(--key-w);
  box-sizing: border-box;
}

/* each special button is half-height of numeric button (approx) */
#keyboard[data-mode="numpad"] .special-wrapper .sp-btn {
  flex: 1 1 0;
  min-width: var(--key-w);
  min-height: calc((var(--key-h) * 2 - var(--gap-vertical)) / 2 + 1px);
  border-radius: 8px;
  background: var(--button-bg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  cursor: pointer;
  border: none;
  box-sizing: border-box;
}

#keyboard[data-mode="numpad"] .special-wrapper .sp-btn .btn-icon {
  width: 1.4em;
  height: 1.4em;
}

/* space-row small adjust for numpad */
#keyboard[data-mode="numpad"] .space-row {
  margin-top: var(--gap-vertical);
  height: var(--key-h);
}

/* SELECTION RULES (linha -> confirmação) */

#keyboard>button.row-selected,
#keyboard[data-mode="numpad"] .num-btn.row-selected {
  background: var(--select-linha);
  color: #000;
}

#keyboard .compound-cell.row-selected>.half-btn {
  background: var(--select-linha);
  color: #000;
}

#keyboard[data-mode="numpad"] .special-wrapper .sp-btn.row-selected {
  background: var(--select-linha);
  color: #000;
}

#keyboard .space-row.row-selected {
  background: var(--select-linha);
  color: #000;
}

#keyboard>button.selected,
#keyboard[data-mode="numpad"] .num-btn.selected {
  background: var(--button-selected);
  color: #000;
}

#keyboard .compound-cell .half-btn.selected {
  background: var(--button-selected);
  color: #000;
}

#keyboard[data-mode="numpad"] .special-wrapper .sp-btn.selected {
  background: var(--button-selected);
  color: #000;
}

#keyboard .space-row.selected {
  background: var(--button-selected);
  color: #000;
}

/* Misc / helpers */
.icon-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 6px 8px;
  box-sizing: border-box;
}

#piscas {
  margin-top: 15px;
  font-size: 18px;
  color: var(--highlight);
  font-weight: bold;
  grid-column: 1 / -1;
  text-align: center;
}